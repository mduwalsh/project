\chapter{Violation in Crossover Distribution} \label{ch:chiviolation}
This chapter explores the robustness of finite population oscillation when condition \ref{OscCond} 
for the crossover distribution is violated and infinite population trajectories
have no periodic orbit.

Error $\bm{\epsilon}$ is introduced into the crossover distribution $\bm{\chi}$ so as to 
violate condition \ref{OscCond}; this guarantees that 
infinite population trajectories have no periodic orbit. Consequently, $\bm{p}^\ast \;=\; \bm{q}^\ast \;=\; \bm{z}^\ast$. 
The initial population is 
computed using the same procedure as described in section \ref{InitPopOsc}. To explore the effects of the degree  
of violation of condition \ref{OscCond} in $\bm{\chi}$, different values of $\bm{\epsilon}$ are used in experiments. 
String length $\ell \;\in\; \{8, 10, 12, 14\}$ is considered for simulation.
Going forward, we use `limit $\bm{z}^\ast$' to denote evolutionary limit when crossover distribution 
$\bm{\chi}$ violates condition \ref{OscCond}, and 
`non-violation limits $\bm{p}^\ast$ and $\bm{q}^\ast$' to denote limits without violations (i.e., $\bm{\epsilon \,=\, 0}$).

\section{Violation}
The crossover distribution $\bm{\chi}$ was modified as
\[
\bm{\chi}_i = (1-\bm{\epsilon}) \bm{\chi}_i\ 
\]
So that 
\[
\bm{\chi}_i + \bm{\chi}_{i+g} = 1-\bm{\epsilon} ; \tabspace g \text{ is defined in  section } \ref{Limits}
\]

Then a single $j$ is chosen where $\bm{\chi}_j = 0$ and we set $\bm{\chi}_j = \bm{\epsilon}$. 

Violation in crossover distribution $\bm{\chi}$ is different from violation in mutation distribution $\bm{\mu}$. 
The Markov chain formed by transition matrix $Q$ is regular under violation in $\bm{\mu}$ 
but that need not be the case under violation in  $\bm{\chi}$. 
% With $\bm{\chi}$ described above, non-crossover mask (all 0s) has always positive probability. 
% And since we do not modify the mutation distribution $\bm{\mu}$ satisfying condition \ref{OscCond}, 
% the non-mutation mask (all 0s) has always zero probability. 
% However, applying same mutation mask twice with non-crossover event, 
% we can achieve non mutation event in two generations. 
% 
% % Let us exlore for two cases of $g$ in \ref{OscCond}:
% % 
% % 1. When $g$ is all $1$s:\newline
% % Any mask with a $1$ at position $k$ ($0 \leq k < \ell$) and $0$ at all other positions can mutate the $k$th bit of a string.  In next step, 
% % either the string can mutate its next bit or the string can simulate non-mutation event in two generations (mutate $j$th bit twice). 
% % This makes possibile for any string to mutate to 
% % any other string. And any string can maintain its bits in even number of generations after aquiring its state. 
% % 
% % 2. When $g$ has atleast one $0$:\newline
% % Any mask with a $1$ at position $k$ and $0$ at all other positions  
% % will have positive probability if $g$ also is $1$ at position $k$. 
% % Thus any bit where $g$ is $1$ can mutate.  
% % Any mask with $1$ in just one of the positions where $g$ has $1$s and 
% % also $1$ in just one of the positions where $g$ has $0$s can be used to 
% % mutate a bit where $g$ is $0$ using two masks in sequence. 
% % So any string can mutate to any other. 
% % Also any string requires two generations to simulate non-mutation event. 
% 
% Any mask with a $1$ at position $k$ and $0$ at all other positions  
% will have positive probability if $g$ also is $1$ at position $k$. 
% Thus any bit where $g$ is $1$ can mutate. 
% 
% 1. Mutate a bit in string where $g$ has $0$: 
% Any mask with $1$ in just one of the positions where $g$ has $1$s and 
% also $1$ in just one of the positions where $g$ has $0$s can be used to 
% mutate a bit where $g$ is $0$ using these two masks in sequence in two steps. 
% 
% 2.
% Any bit in a string at position where $g$ 
% is $1$ can be mutated in two steps. 
% 
% So any string can mutate to any other in even number of steps. 
% Also any string requires two generations to simulate non-mutation event.
% So any population can therefore mutate to any other population in even number of generations, 
% and that makes the Markov chain irreducible.
% 
% In this research, experiment is designed to have finite population size as multiple of 2. 
% So, there is a special set of population $P_s$ which can mutate to itself, i.e. one string in 
% population can mutate to another string in population maintaining same population member strings within. 
% Since any population can mutate to any other population, let us assume finite population $P_i$ 
% can reach special population $P_s$ in $u$ (even) generations. Population $P_s$ can stay in its state as long as its wants 
% by mutating to itself or mutate to next population state. Population $P_s$ can return to $P_i$ next $u$ generations. 
% Let's say $P_s$ stays as $P_s$ for $h$ generations. Then population $P_i$ can return to its original state $P_i$ 
% in total $2u+h$ generations. $h$ can be $1, \; 2, \;, 3,$ and so on. That means $P_i$ can return to its original state in 
% odd or even number of generations. So, the Markov chain is also aperiodic.
% 
% Since the Markov chain formed by GA after the violation in $\bm{\chi}$ is irreducible and aperiodic, 
% the Markov chain is regular (see \cite{Iosifescu1980}), and a steady state distribution 
% with positive components exists for the GA (see \cite{Minc1988}). 

Simulations are repeated with the violation levels $\bm{\epsilon}$ described above.
The distances of both infinite and finite populations to limit $\bm{z}^\ast$ are plotted. 
The distances of both infinite and finite populations to non-violation limits $\bm{p}^\ast$ and $\bm{q}^\ast$ are also plotted.

\clearpage
% figures for chi violation
\subsection{Haploid Population $\mathtt{\sim}$ $\epsilon: 0.01$}
\input{chapters/vio-chi-hap-e0.01.tex}
\subsection{Haploid Population $\mathtt{\sim}$ $\epsilon: 0.1$}
\input{chapters/vio-chi-hap-e0.1.tex}
\subsection{Haploid Population $\mathtt{\sim}$ $\epsilon: 0.5$}
\input{chapters/vio-chi-hap-e0.5.tex}
\clearpage
\subsection{Diploid Population $\mathtt{\sim}$ $\epsilon: 0.01$}
\input{chapters/vio-chi-dip-e0.01.tex}
\clearpage
\subsection{Diploid Population $\mathtt{\sim}$ $\epsilon: 0.1$}
\input{chapters/vio-chi-dip-e0.1.tex}
\subsection{Diploid Population $\mathtt{\sim}$ $\epsilon: 0.5$}
\input{chapters/vio-chi-dip-e0.5.tex}

\section{Discussion}
In the presence of violation in $\bm{\mu}$, the amplitude of oscillation decreases 
as string length $\ell$ increases. 
Larger population sizes show better oscillation. 
Since diploid populations have effective string length twice the size of haploid populations, 
diploid populations need larger population size than haploid population to exhibit good oscillation. 
As in the case of violation in $\bm{\mu}$, increasing string length $\ell$ 
degrades convergence (as finite population size increases) to infinite population behavior for diploid populations. 
That behavior is noticeable in figures 
\ref{oscillation_8d_vio_chi_0.01} through \ref{oscillation_14d_vio_chi_0.5} for violation in $\bm{\chi}$. 
That behavior is less noticeable in haploid populations.

With increase in the value of $\bm{\epsilon}$, 
oscillation in population diminishes and dampening of oscillation increases. 
Randomness increases with increasing $\bm{\epsilon}$.
Comparing oscillation with violation in $\bm{\mu}$ and $\bm{\chi}$, rate of dampening of oscillation with violation 
in $\bm{\chi}$ seems to be slower than with violation in ${\bm{\mu}}$. 
Diploid populations jumping to other levels 
were observed for string lengths 12 and 14 and population size 4096  ( 
figures \ref{oscillation_12d_vio_chi_0.01}, \ref{oscillation_14d_vio_chi_0.01}, \ref{oscillation_12d_vio_chi_0.1}, 
\ref{oscillation_14d_vio_chi_0.1}, \ref{oscillation_12d_vio_chi_0.5} and \ref{oscillation_14d_vio_chi_0.5}), 
but unlike the case of violation in $\bm{\mu}$, 
the behavior is noticeable when the population size is larger (figure \ref{oscillation_12d_vio_chi_0.1}). 

As in $\bm{\mu}$ violation, we noticed similar unexpected behavior also in presence of violation in $\bm{\chi}$: 
figures \ref{oscillation_12d_vio_chi_0.5} and \ref{oscillation_14d_vio_chi_0.5} 
show that the lines representing distance of population to limits $\bm{p}^\ast$ and $\bm{q}^\ast$ overlap. 
The graphs suggest that finite population evolution is exploring a plane equidistant from $\bm{p}^\ast$ and $\bm{q}^\ast$.

Moreover, in figures \ref{oscillation_12d_vio_chi_0.1} and \ref{oscillation_14d_vio_chi_0.1}, infinite population oscillation dies out to 
give graph of single line. But infinite population is converging to limit $\bm{z}^\ast$. 
This suggests $\bm{z}^\ast$ may be somewhere in equidistant plane from $\bm{p}^\ast$ and $\bm{q}^\ast$.

\begin{figure}[!ht]
\begin{center}
\subfloat{
\resizebox{16cm}{10cm}{\includegraphics{figures/eps/vio/dist_chi.eps}}}\hspace{-3em}%
\caption[\textbf{Distance between finite and infinite population in case of violation in $\bm{\chi}$}]{\textbf{Distance between finite and infinite population in case of violation in $\bm{\chi}$:}  
  $d$ is distance; $N$ is finite population size; $\bm{\epsilon}$ is level of violation; 
  red line represents distance for $\ell = 8$, green line for $\ell = 10$, blue line for $\ell = 12$, pink line for $\ell = 14$ 
  and black dotted line for expected single step distance.}
\label{vio_chi_dist}
\end{center}
\end{figure}

Figure \ref{vio_chi_dist} summarizes the distance data from tables \ref{distanceChiHapEps0.01} through 
\ref{distanceChiDipEps0.5}. Distance between infinite and finite populations 
for population sizes {4096, 40960, 81920} are plotted for different $\ell$. 
Plots for different violation levels $\bm{\epsilon}$ are arranged in columns. 
Plots for haploid and diploid populations are arranged in two rows. With increase in $\ell$, 
distance between finite and infinite population moves closer to the single step distance. So, since diploid effective population 
string length is twice that of haploid population, 
distance in diploid case moves closer to the single step distance for the same value of $\ell$ than in haploid case. 
Like in the case of $\bm{\mu}$ violation, it is more noticeable in haploid population case that as $\bm{\epsilon}$ increases, 
the distance moves closer to the single step distance.

\section{Summary}
In this chapter, we violated condition \ref{OscCond} for the crossover distribution, 
so that infinite population trajectories have no periodic orbit. 
We explored infinite and finite population oscillation behavior with the violation through experiments. 
We don't know if the Markov chain is regular in this case but we suspect it is not.  
Like in case of $\bm{\mu}$ violation, infinite population oscillation dies out when condition \ref{OscCond} for convergence to 
periodic orbits is violated, but finite populations approximately oscillate for small values of $\bm{\epsilon}$ 
because the probability of using the new mask is low, and not used, 
finite population follows behavior of infinite population without violation in the condition for convergence to 
periodic orbits. However, rate of dampening of oscillation with violation 
in $\bm{\chi}$ is observed to be slower than with violation in ${\bm{\mu}}$. Also more randomness in oscillations are observed 
in this case than in violation in mutation, especially for diploid population.




