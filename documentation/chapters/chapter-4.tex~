\chapter{Adaptation of Walsh Transformation} \label{ch:walsh transformation}

\section{Walsh Functions and Walsh Transorm}
Walsh functions are orthonormal set of functions that form an ordered set of rectangular waveforms taking 
only two amplitude values +1 and -1 and are defined over a limited time interval, time-base $T$ which requires to be known if quantative values are to be assigned to a function. Like in sine-cosine functions, two arguments are necessary to completely define 
walsh function, a time period , $t$, and an ordering number, $n$. The function can be written as
\[
WAL(n,t)
\]
A time series, f(t), in terms of a series of Walsh funcitons \cite{Beauchamp1975}, viz.
\[
f(t) = a_{0} WAL(0, t) + \sum_{n=1}^{N-1} a_n WAL(n,t)
\]
where $N$ is number of terms used in Walsh series to express time series and
\[
\frac{a_0}{2} = \frac{1}{T} \int\limits_0^T f(t) WAL(0,t) dt
\]
\[
a_n = \frac{1}{T} \int\limits_0^T f(t) WAL(n,t) dt
\]

According to Beauchamp \cite{Beauchamp1975}, the above definition for the Walsh functions may be restated by saying that every function $f(t)$ which is integrable is capable of being represented by a Walsh series defined over the open interval (0, 1) as 
\[
x(t) = a_0 + a_1 WAL(1,t) + a_2 WAL(2,t) + ....
\]
where the coefficients are given by
\[
a_k = \int\limits_0^1 f(t) WAL(k,t) dt
\]
and a transform pair can be defined,
\[
f(t) = \sum_{k=0}^\infty F(k) WAL(k,t)
\]
\[
F(k) = \int\limits_0^1 f(t) WAL(k,t) dt
\]

This is for continuous function limited in time over the interval $0 \geqslant t \geqslant 1$. Finite discrete Walsh transform pair on N sampling points, $x_i$, can be expressed as
\[
X_n = \frac{1}{N} \sum_{i=0}^{N-1} x_i WAL(n,i)
\]
\[
n = 0, 1, 2...N-1
\]
and
\[
x_i = \sum_{n=0}^{N-1} X_n WAL(n,i)
\]
\[
i = 0, 1, 2...N-1
\]

The Walsh function series WAL(n,t) can be obtained using Walsh matrix also known as Hadamard matrix of order N. 
Walsh matrix or Hadamard matrix is a square matrix of order N whose coefficients comprise only +1 and -1 and where its rows 
(and columns) are orthogonal to one another. 
Let us represent Walsh matrix as $W$ so WAL(n,t) is represented by $W_{n,t}$. The Walsh matrix is defined by
\[
W_{n,t} = N^{-1/2} (-1)^{n.t}
\]
where $N^{-1/2}$ is normalization factor and $n.t$ is bitwise dot product of binary representation of number n and t.

The matrix is symmetric, i.e.,
\[
W_{n,t} = W_{n,t}
\]
and it has entries satisfying
\[
W_{n, t \oplus k} = N^{1/2} W_{n, t} W_{n, k}
\]

The practical importance of this symmetry is that the transform and inverse represent same mathematical operation, hence simplifying the derivation and application of the transform. With the normalized form, \textit{Walsh matrix} is it is its own inverse, i.e.,
\[
W = W^{-1}
\]

In the matrix form, given vector $w$ and matrix $A$, let $\widehat{w}$ and
$\widehat{A}$ denote the Walsh transform of $w$ and $A$ respectively. Then $\widehat{w} = Ww$ and
$\widehat{A} = WAW$. If $w$ is a row vector, then $w$ in its Walsh basis $\widehat{w}$ represents $wW$.

\section{Walsh Transform Adaptation}
The Walsh transform has spectacular ability to unravel the intricacies of mixing. And that is why we adapt Walsh transform methods for computing evolutionary trajectories, which have already been established for Vose's haploid model \cite{Vose1999}. Adaptation of Walsh transformation efficiently models infinite diploid population evolution. This adaptation of Walsh transormation helps in making feasible comparisons between finite and infinte diploid population short-term evolutionary behavior.
Recalling evolution equation (\ref{model4}), without selection, specialized to Vose's infinite population model expressed in mixing matrix's term,
\[
p_g^\prime \; = \; (\sigma_g \nudge p)^T M \, (\sigma_g \nudge p)
\]
where the permutation matrix $\sigma_g$ is defined by component
equations
\[
(\sigma_g)_{u,v} \; = \; [\nudge u+v = g\nudge ]
\]

In our model, the Walsh matrix $W$
is defined by component equations
\[
W_{u,v} \; = \; 2^{-\ell/2} (-1)^{u^T v}
\]
where the subscripts \nudge u, \nudge v (which belong to $\mathcal{R}$) on the left hand side are interpreted on the right hand side as column vectors in $\mathbb{R}^{\ell}$.
Columns of $W$ form the orthonormal basis --- the
{\em Walsh basis\/} --- which simultaneously diagonalizes the
$\sigma_g$.

A change of basis which simultaneously diagonalizes the $\sigma_g$
unravels the evolution equation (\ref{model4}).  
Expressed in the Walsh basis (see \cite{Vose1999}), the mixing matrix
takes the form
\begin{equation}
\label{Mhat}
\widehat{M}_{u,v} \; = \; 2^{\,\ell-1} \,[\nudge u \nudge v = {\bf
    0}\nudge]\, \widehat{\mu}_u \nudge \widehat{\mu}_v \!  \sum_{k
  \nudge \in \nudge \overline{u+v} \nudge \mathcal{R}} \chi_{k + u} +
\chi_{k + v}
\end{equation}
and equation (\ref{model4}) takes the form
\begin{equation}
\label{model5}
\widehat{p}_g^{\,\,\prime} \; = \; 2^{\,\ell/2} \sum_{i \nudge \in \nudge g \mathcal{R}}
\widehat{p}_i \, \nudge \widehat{p}_{i+g} \,\widehat{M}_{i,i+g}
\end{equation}
where $g \mathcal{R} = \{g \nudge i \, | \, i \in \mathcal{R} \}$ (for
any $g \in \mathcal{R}$).

The mapping from generation $n$ to generation $n+1$, determined in
natural coordinates by equation (\ref{model3}) in terms of the
transmission function (\ref{Mg}), and given in Walsh coordinates by
equation (\ref{model5}) in terms of the mixing matrix (\ref{Mhat}), is
Markovian; the next state $p^\prime$ depends only upon the current
state $p$.  Let $\mathcal{M}$ represent the mixing transformation,
\begin{equation} \label{mixing_transformation}
p^\prime \; = \; \mathcal{M}(p)
\end{equation}
and let $\mathcal{M}^n(p)$ denote the $n$-fold composition of
$\mathcal{M}$ with itself; thus generation $n$ is described by
\[
p^n \; = \; \mathcal{M}^n(p^0)
\]
where $p^0$ represents the initial population.  We have little to say
about the matrix of the Markov chain corresponding to the mixing
transformation $\mathcal{M}$, because it is uncountable; each state is
a distribution vector $p$ describing a population. However, that is
not an obstacle to computing evolutionary trajectories;
(\ref{mixing_transformation}) can be computed in Walsh coordinates
relatively efficiently via (\ref{Mhat}) and (\ref{model5}).


