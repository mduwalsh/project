\chapter{Evolutionary Limits} \label{ch:evolutionary limits}
This chapter investigates evolutionary limits predicted by Vose using infinite population model under no selective pressure. 
It uses computation to verify predicted infinite population limits and presents necessary and sufficient conditions obtained by Vose for 
convergence to periodic orbits. We investigate the convergence of finite population short-term behavior 
to infinite population evolutionary limits under no selective pressure. Infinite and finite population behavior when 
the necessary and sufficient conditions for convergence to periodic orbits are violated is also examined.

\section{Limits}
\label{Limits}
Vose states under mild assumptions on mutations (explained later), populations converge under repeated application 
of $\mathcal{M}$. Vose mentions that in the general case, periodic orbits are possible, but populations converge under 
repeated application of $\mathcal{M}^2$ and the limits ${\bm p}^\ast = \lim_{n \rightarrow \infty} \mathcal{M}^{2n}({\bm p})$ 
and ${\bm q}^\ast = \lim_{n \rightarrow \infty} \mathcal{M}^{2n+1}({\bm q})$ exist (see \cite{Vose1999}).

In this section, operations ($+$ and $\cdot$) acting on elements of $\mathcal{R}$ are component-wise addition and multiplication modulo 2. 

Following Vose (see \cite{Vose1999}), let $S_g = g \mathcal{R} / \{\textbf{0}, g\}$, and let $|g|$ be the number of non zero bits in $g$.
\[
{{\widehat{{\bm p}}}_g}^{\prime}  = \begin{cases}
    2^{\ell /2}  & \text{if $g = 0$}\\
    x_g \widehat{{\bm p}}_g + y_g(\widehat{{\bm p}}_g) & \text{otherwise}
  \end{cases}
\]
where,
\[
x_g = 2\widehat{\mathcal{M}}_{g,0},  \hspace*{1cm} y_g(z) = 2^{\ell /2} \sum_{i \in S_g} z_i z_{i+g} \widehat{\mathcal{M}}_{i,i+g}.
\]

Moreover, 
\begin{eqnarray*}
|g| & = & 1 \nudge \Rightarrow y_g = 0 \\
|g| & > & 0 \nudge \Rightarrow |x_g| \leq 1 \\
|x_g| & = & 1 \nudge \Rightarrow y_g = 0
\end{eqnarray*}

With above notations, limits can be expressed in Walsh basis by recursive equations (see \cite{Vose1999})
\begin{equation}
\label{lt1}
\widehat{{\bm p}^{\ast}}_g  = \begin{cases}
    (x_g y_g(\widehat{{\bm p}^{\ast}}) + y_g(\widehat{{\bm q}^{\ast}}))/(1-x_g^2)  & \text{if $|x_g| < 0$}\\
    \widehat{p}_g  & \text{otherwise}
  \end{cases}
\end{equation}
\begin{equation}
\label{lt2}
\widehat{{\bm q}^{\ast}}_g  = \begin{cases}
    (x_g y_g(\widehat{{\bm q}^{\ast}}) + y_g(\widehat{{\bm p}^{\ast}}))/(1-x_g^2)  & \text{if $|x_g| < 0$}\\
    \widehat{\mathcal{M}({\bm p})_g}  & \text{otherwise}
  \end{cases}
\end{equation}

If $x_g \neq -1$ for all $g$, then ${\bm p}^\ast = {\bm q}^\ast = \lim_{n \rightarrow \infty} \mathcal{M}({\bm p})$ is the limit of mixing. In other cases, 
mixing converges to a periodic orbit oscillating between ${\bm p}^\ast$ and ${\bm q}^\ast = \mathcal{M}({\bm p}^\ast)$.

Limits $\widehat{{\bm p}^{\ast}}_g$ and $\widehat{{\bm q}^{\ast}_g}$ can be computed considering $g$th components in order of increasing $|g|$.
The necessary and sufficient condition for the sequence
\[
\bm{p}, \mathcal{M}({\bm p}), \mathcal{M}^2({\bm p}),...
\]
to converge to a periodic orbit given by Vose is that for some $g$
\begin{equation}
\label{OscCond}
-1 = \sum \limits_{j} (-1)^{g^T j} \bm{\mu}_j = - \sum \limits_{k \in \bar{g}\mathcal{R}} \bm{\chi}_{k+g} + \bm{\chi}_k
\end{equation}
 
\section{Computation of Mutation and Crossover Distribution}
The following algorithm generates mutation and crossover distributions that satisfying equation (\ref{OscCond}) 
for evolution to converge to periodic orbits. Operations ($+$ and $\cdot$) acting on elements of $\mathcal{R}$ 
in this section below are component-wise addition and multiplication modulo 2. 
Let $\bm{\mu}_j$ and $\bm{\chi}_k$ represent mutation and crossover distributions respectively where $j,k \in \mathcal{R}$ 
and $U01()$ is a random number between $0$ and $1$. For any $g \in \mathcal{R}$ and $g \neq 0$ and for all $j \in \mathcal{R}$,
\[
\bm{\mu}_j = \begin{cases}
    U01() & \text{if $(g^T\cdot j)$ is odd}.\\
    0 & \text{otherwise}.
  \end{cases}
\]

This installs random values in some specific positions in $\bm{\mu}$ according to value of $g$. Other components of $\bm{\mu}$ are set to $0$. 
Normalization of $\bm{\mu}_j$ yields $\bm{\mu}$ (the mutation distribution),
\[
\bm{\mu}_j = \bm{\mu}_j / \sum \limits_{j \in \mathcal{R} } \bm{\mu}_j.
\]
Hence 
\[
\sum \limits_{j \in \mathcal{R} } \bm{\mu}_j = 1.
\]
Moreover, the values $\bm{\mu}_j$ satisfy condition (\ref{OscCond}).

Condition $k \in \bar{g} \mathcal{R}$ in equation (\ref{OscCond}) can be simplified for computation as
\[
k = \bar{g} i  \text{ where $i \in \mathcal{R}$}
\]
Logical bitwise ANDing both sides by $\bar{g}$,
\begin{equation*}
\bar{g} k = \bar{g} \bar{g} i \; = \; \bar{g} i \; = \; k 
\end{equation*}
The crossover distribution can be generated as follows.
For all $k \in \mathcal{R}$,
\begin{eqnarray*}
\bm{\chi}_k & = & U01() \\
\bm{\chi}_{k+g} & = & U01() 
\end{eqnarray*}
where $k \in \bar{g} \mathcal{R}$, and
\[
\bm{\chi}_k = 0
\]
for other values of $k$. 
This installs random values in some specific positions in $\bm{\chi}$ according to the value of $g$. 
Other components of $\bm{\chi}$ are set to $0$. Normalization of $\bm{\chi}_k$ yields 
$\bm{\chi}$ (the crossover distribution),
\[
\bm{\chi}_k = \bm{\chi}_k/\sum\limits_{k \in \mathcal{R}} \bm{\chi}_k.
\]
Hence 
\[
\sum\limits_{k \in \mathcal{R}} \bm{\chi}_k = 1.
\]
Moreover, the values $\bm{\chi}_k$ satisfy condition (\ref{OscCond}).

\section{Initial Population}
\label{InitPopOsc}

\begin{figure}[H]
\begin{center}
\resizebox*{12cm}{!}{\includegraphics{figures/eps/initialpop.eps}}\hspace{4pt}
\caption{\textbf{Initial population computation} }
\label{initialpop}
\end{center}
\end{figure}

Let finite haploid population $\bm{s}^n$, finite diploid population $\bm{f}^n$, infinite haploid population $\bm{p}^n$ 
and infinite haploid population $\bm{q}^n$ be considered with initial population $\bm{s}^0$, $\bm{f}^0$,
$\bm{p}^0$, $\bm{q}^0$ respectively. To investigate oscillating behavior of infinite population evolutionary limits 
and finite population behavior, it is desirable to have the same initial population. 

For a length $\ell$, $x = 2^\ell$ is the number of possible haploids. Let array $\bm{t}$ represent a  
population size of $N$ as follows: $\bm{t}_j$ is the $j$th population member (some element of $\{0,..,x-1\}$ 
where elements are base 2 length l binary strings). Array $\bm{t}$ is generated as follows. 
First an arbitrary vector $\bm{v}$ of size $x$ is considered where
\[
\bm{v}_i = U01(); \tabspace {i = 0, 1,.., x-1}
\]
and U01() is random number between 0 and 1.
\[
\bm{t}_j = randp(\bm{v}) ; \tabspace {j = 0,.., N-1}
\]
where $randp(\bm{v})$ returns random index $i$ in array $\bm{v}$ with probability $\bm{v}_i$.

Let $\bm{c}_i$ represent count of haploid member $i$ in population $\bm{t}$ given by
\[
\bm{c}_i = \sum \limits_{j=0}^{N-1} [\bm{t}_j = i]  \nudge; \tabspace  {i = 0,.., x-1}
\]
Then infinite population vector $\bm{p}$ is calculated as
\[
\bm{p}_i = \frac{\bm{c}_i}{ \sum \limits_{k=0}^{x-1} \bm{c}_k }
\]
where $i = 0,.., x-1$ and $\sum \limits_{k=0}^{x-1} \bm{c}_k = N$.

This $\bm{p}$ is randomly generated initial infinite haploid population vector ($\bm{p}^0$) which corresponds to diploid infinite population vector $\bm{q}$ 
and finite population vectors $\bm{s}$ and $\bm{f}$.

Finite haploid population members $\bm{t}_j$s are generated again to match finite haploid population $\bm{s}^0$ with infinite haploid population $\bm{p}^0$.
\[
\bm{c}_i = N \cdot \bm{p}_i 
\]
\[
\sum \limits_{j=0}^{N-1} [\bm{t}_j = i] = \bm{c}_i  \nudge; \tabspace  {i = 0,.., x-1} 
\]
Initial infinite diploid population $\bm{q}_0$ is calculated corresponding to initial haploid population $\bm{p}^0$ as
\[
\bm{q}^0_{i,j} = \bm{p}^0_i \cdot \bm{p}^0_j  \nudge; \tabspace  (0 \leq i,j < x).
\]
Let $\bm{v}$ represent finite diploid population member array of size $N^2$ and $\bm{d}_{i,j}$ represent count of 
diploid member $\langle i,j \rangle$ in $\bm{v}$. Then $\bm{v}$ can be filled with population member to match 
initial population vector $\bm{p}$ generating diploid members such that
\begin{eqnarray*}
\bm{d}_{i,j} & = & N \cdot \bm{p}_i \cdot N \cdot \bm{p}_j  \\
\sum \limits_{k=0}^{N^2-1} [ \bm{v}_k = \langle i,j \rangle ] & = & \bm{d}_{i,j}
\end{eqnarray*}

Finite diploid population (proportion) vector $\bm{f}$ can be obtained from finite diploid population member array $\bm{v}$  using
\[
f_{i,j} = \frac{\bm{d}_{i,j}}{\sum \limits_{k=0}^{x-1} \sum \limits_{h=0}^{x-1} \bm{d}_{k,h}}
\]
where $i = 0,.., x-1$, $h = 0,.., x-1$ and $\sum \limits_{k=0}^{x-1} \sum \limits_{h=0}^{x-1} \bm{d}_{k,h} = N^2$.

Thus, initial infinite haploid population vector $\bm{p}^0$ corresponds to initial infinite diploid population vector $\bm{q}^0$, initial finite 
haploid population vector with population size $N$ and initial finite diploid population vector with population size $N^2$.

\section{Oscillation}
\label{Oscillation}

Equations (\ref{lt1}) and (\ref{lt2}) were implemented with crossover distribution $\bm{\chi}$ and mutation distribution $\bm{\mu}$ satisfying 
condition (\ref{OscCond}) to investigate oscillating behavior of predicted infinite population evolutionary limits $\bm{p}^{\ast}$ and $\bm{q}^{\ast}$ 
and finite population under no selective pressure.

Infinite haploid population evolutionary limits $\bm{p}_h^{\ast}$ and $\bm{q}_h^{\ast}$ were computed using equations (\ref{lt1}) and (\ref{lt2}). 
Infinite diploid population evolutionary limits $\bm{p}_d^{\ast}$ and $\bm{q}_d^{\ast}$ as
\begin{eqnarray*}
({\bm{p}_d^{\ast}})_{\langle \gamma_0, \gamma_1 \rangle} & = & ({\bm{p}_h^{\ast}})_{\gamma_0} ({\bm{p}_h^{\ast}})_{\gamma_1} \\
({\bm{q}_d^{\ast}})_{\langle \gamma_0, \gamma_1 \rangle} & = & ({\bm{q}_h^{\ast}})_{\gamma_0} ({\bm{q}_h^{\ast}})_{\gamma_1}
\end{eqnarray*}
where $\gamma = \langle \gamma_0, \gamma_1 \rangle$ is diploid genome.

For every genome length $\ell$, the same initial population (calculated as described in (\ref{InitPopOsc})) was used for the infinite population and all 
sizes of finite populations conisdered.
Genome lengths $\ell \in \{8, \nudge10, \nudge12, \nudge14\}$ were used. Base population size of $N_0 = 64$ was used 
for the finite haploid case to compute initial population vector. The population sizes considered for plotting 
graphs were $N \in \{1N_0^2, \nudge10N_0^2, \nudge20N_0^2\}$. 
The distances of $\bm{p}^n$ and $\bm{s}^n$ to haploid evolutionary limits $\bm{p}_h^{\ast}$ and 
$\bm{q}_h^{\ast}$ were plotted and the distances of $\bm{q}^n$ and 
$\bm{f}^n$ to diploid evolutionary limits $\bm{p}_d^{\ast}$ and $\bm{q}_d^{\ast}$ were plotted. 
Distance data of finite population to infinite population were also plotted.
%oscillation
\input{chapters/oscillation.tex}

\textbf{ Figures} \ref{oscillation_8h}, \ref{oscillation_8d}, \ref{oscillation_10h}, \ref{oscillation_10d}, \ref{oscillation_12h}, \ref{oscillation_12d}, 
\ref{oscillation_14h} and \ref{oscillation_14d} arranged by genome length $\ell$ in ascending order. For each genome length, figures are split into two 
cases, haploid and diploid cases of population. In each figure for unique genome length $\ell$ and population case (either haploid or diploid), sub-figures 
are arranged by population size ($N$). In each figure, first three rows of sub-figures on left column shows distance of finite population 
to limits and sub-figure in fourth row on left column shows distance of infinite population to limits. These sub-figures depicts 
oscillating behavior of both infinite and finite population when necessary and sufficient condition \ref{OscCond} is met. 
Finite population oscillation in both the haploid and diploid case is sharper with increased population size. 
As population size increases, oscillation approaches the behavior exhibited by infinite population. 

In each figure (\ref{oscillation_8h}, \ref{oscillation_8d}, \ref{oscillation_10h}, \ref{oscillation_10d}, 
\ref{oscillation_12h}, \ref{oscillation_12d}, 
\ref{oscillation_14h} and \ref{oscillation_14d}), first three rows of graphs on right side shows 
distance variation (difference in distance ($d$) and average distance ($d_{avg}$))  
where $d$ is distance between finite and infinite populations and $d_{avg}$ is average value of $d$. 
In fourth row on right, a single graph for distances ($d$) of different finite population sizes 
($N = 1N_0^2, \nudge10N_0^2, \nudge20N_0^2$) to infinite population are plotted. The resulting graphs shows distance decreases 
as population size increases which is consistent with results from section \ref{convergence}. 
The distance graphs smooth as population size increases. The graphs of $d-d_{avg}$ decreases in amplitude as population size increases.

The numerator in equation \ref{convergenceRHS} is approximately $1$. 
So from \ref{convergenceRHS}, the expected single step distance between finite and infinite population, $d$, is
\[
d \approx 1/\sqrt{N}
\]
where $N$ is the population size.
This expected single step distance is shown in table \ref{tableExpectedDistance}.
\begin{table}[ht]
\caption{\textbf{Expected single step distance $d$ for population size $N$}}
\centering
\begin{tabular}{c c c c}
\hline
$N$ & 4096 & 40960 & 81920 \\
$d$ & 0.0156 & 0.0049 & 0.0035 \\
\hline
\end{tabular}
\label{tableExpectedDistance}
\end{table}
Distance data obtained from simulations are summarized in table \ref{tableDistanceOsc}. The 
last three columns tabulate average distance values between finite and infinite population 
for population sizes $N \;=\; 4096 $, $N \;=\; 40960 $ and $N \;=\; 81920 $ respectively.
\begin{table}[ht]
\caption{\textbf{Experimental distance measured for oscillation:} $N$ is population size, $\ell$ is genome length 
and average distance between finite and infinite population is tabulated in the last three columns. $\{4096, \nudge 40960, \nudge 81920\}$ }
\centering
\begin{tabularx}{0.75\textwidth}{ c *{4}{X}}
\toprule
case & $\ell$ & $N \;=\; 4096 $ & $N \;=\; 40960 $ & $N \;=\; 81920 $\\
\midrule
\multirow{4}{*}{haploid} 	& 8 & 0.0158 & 0.0051 & 0.0035 \\
 				& 10 & 0.0157 & 0.0050 & 0.0035 \\ 
 			 	& 12 & 0.0156 & 0.0049 & 0.0035 \\
 	 			& 14 & 0.0156 & 0.0049 & 0.0035 \\ 
\midrule
\multirow{4}{*}{diploid} 	& 8 & 0.0156 & 0.0049 & 0.0035 \\
				& 10 & 0.0156 & 0.0049 & 0.0035 \\
			 	& 12 & 0.0156 & 0.0049 & 0.0035 \\
	 			& 14 & 0.0156 & 0.0049 & 0.0035 \\
\bottomrule

\end{tabularx}
\label{tableDistanceOsc}
\end{table}
Results from table \ref{tableDistanceOsc} show average distance between finite and infinite population follows closely 
the expected single step distance given in table \ref{tableExpectedDistance}. The distance decreases as $1/\sqrt{N}$.

\section{Violation}
Previous results show that oscillation occurs when the crossover distribution $\bm{\chi}$ ,and the mutation distribution $\bm{\mu}$ 
satisfy (\ref{OscCond}). Error $\bm{\epsilon}$ was introduced to $\bm{\mu}$ and $\bm{\chi}$ distributions to 
violate condition (\ref{OscCond}). Consequently, $\bm{p}^\ast \;=\; \bm{q}^\ast \;=\; \bm{z}^\ast$. 
Going forward, we use 'limit $\bm{z}^\ast$' to denote evolutionary limit when crossover distribution 
$\bm{\chi}$ or mutation distribution $\bm{\mu}$ is violated, and 
'non-violation limits $\bm{p}^\ast$ and $\bm{q}^\ast$' to denote limits without violation.

\subsection{Violation in Mutation Distribution}
The mutation distribution $\bm{\mu}$ was modified as follows
\[
\bm{\mu}_i = (1-\bm{\epsilon}) \bm{\mu}_i \nudge; \tabspace i = \{0, 1, 2,.., 2^{\ell}-1\}.
\]
So that sum of $\bm{\mu}$ distribution becomes, 
\[
1-\bm{\epsilon} = \sum \limits_{i=0}^{2^{\ell}-1} \bm{\mu}_i
\]
Then set
\[
\bm{\mu}_0 = \bm{\epsilon}
\]
% \[
% \bm{\mu}_0 = (1-\bm{\epsilon})\bm{\epsilon}
% \]
% $c$ is total number components in $\bm{\mu}$ satisfying condition $\bm{\mu}_i = 0$ and set those components value as
% \[
% \bm{\mu}_i = \bm{\epsilon}^2/c \; ; \; where \; \bm{\mu}_i = 0
% \]
The mutation distribution $\bm{\mu}$ is normalized such that  $\sum\limits_{i=0}^{2^{\ell}-1}\bm{\mu}_i \;=\; 1$.
This modification makes possible for any population member to mutate to any other possible population member via mutation. 
Let us exlore for two cases of $g$ in \ref{OscCond}:

1. When $g$ is all $1$s:\newline
Any mask $j$ with only one $1$ at any position $k$ ($0 \leq k < \ell$) can mutate $k$th bit in string, and since mask 
all $0$s in has positive probability, strings have option to not mutate. This gives possibility for any string to mutate to 
any possible string in population. Let us take an example with $\ell \;=\; 8$. Let $g \;=\; 11111111$. Then, mask 
$i \;=\; 00000100$ will have positive probability according to condition \ref{OscCond} implementation. 
Mask $i$ can be used to mutate bit of a population string at position $k \;=\; 5$ from left.

2. When $g$ has atleast one $0$:\newline
Any mask $j$ with only one $1$ at any position $k$ ($0 \leq k < \ell$) where $k$th position in $g$ also has $1$ in it 
will have positive probability. So any string can mutate that particular $k$th bit using those masks. And any mask 
with $1$ in any one of the position where $g$ has one in it and $1$ in any position where $g$ has $0$s in it can be used to 
mutate bits in string where $g$ has $0$s in it. Let us take an example with $\ell \;=\; 8$. Let $g \;=\; 11001111$. Then, 
mask $i \;=\; 00000100$ will have positive probability according to condition \ref{OscCond} implementation. Then, also mask 
$j \;=\; 00010100$ will have positive probability. Mask $i$ can be used to mutate string at position $k \;=\; 5$. 
To mutate bit of any string at position $k \;=\; 3$, string can be mutated using mask $i$ and mask $j$ in sequence.

Population in state $P$ can mutate to another state $P\prime$ in next generation. Then it can mutate back to original state $P$ or 
stay in its state $P\prime$ or move to another state $P\prime\prime$ in next generation. Since population state can mutate to 
any state, and any state can be returned to in any period of time, the Markov chain formed by GA is irreducible and aperiodic and hence, 
ergodic (see \cite{MarkovChain}). Because of ergodic Markov chain, steady state distribution with positive value components exists for the GA.   

Simulations were repeated with the violations in (\ref{OscCond}) described above for mutation distribution.
The distances of both infinite and finite populations to limit $\bm{z}^\ast$ were plotted. 
The distances of both infinite and finite populations to non-violation limits $\bm{p}^\ast$ and $\bm{q}^\ast$ were also plotted.

% figures for mu violation
\input{chapters/violation-mu-hap.tex}
The left column of figures \ref{oscillation_8h_vio_mu_0.01} through \ref{oscillation_14h_vio_mu_0.5} 
shows distance of finite and infinite haploid populations to limit $\bm{z^\ast}$ (limit with violation in mutation distribution $\bm{\mu}$). The 
right column shows distance of finite and infinite haploid populations to non-violation limits $\bm{p^\ast}$ and $\bm{q^\ast}$. 
Graphs in right column give picture of oscillating behavior of haploid population given violation. 
Graphs in left column in figures \ref{oscillation_8h_vio_mu_0.01} through \ref{oscillation_14h_vio_mu_0.5} show distance 
between finite population and limit $\bm{z}^\ast$ (limit with violation in $\bm{\mu}$ distribution) for haploid case.

Both finite and infinite populations oscillate given violation. However, ripples die out quickly, 
and oscillation ceases for infinite populations.
In the finite population case, although ripple amplitudes decrease, oscillation didn't die out completely. 

Change in oscillating behavior of population with change in $\bm{\epsilon}$ values $\{0.01, 0.1, 0.5\}$ were also studied. 
Results show ripples damp out faster with increase $\bm{\epsilon}$.
With smaller values of $\bm{\epsilon}$, oscillations were sharper and as value of $\bm{\epsilon}$ increased, 
rate of damping increased. With $\bm{\epsilon} = 0.01$, oscillation is clearly visible and ripples are sharper; with $\bm{\epsilon} = 0.1$ oscillation was visible 
but ripples were damping out quickly;  with $\bm{\epsilon} = 0.5$, oscillation was very minimal or not visible at all. 

The distance between finite population and limit $\bm{z}^\ast$ (limit with violation in $\bm{\mu}$ distribution) 
decreases as finite population size increases, 
and finite population shows behavior similar to infinite population behavior as finite population reach large number. 
Simulation results show infinite population converges 
to limit $\bm{z^\ast}$ quicker with increase in $\bm{\epsilon}$. 

The distance data for haploid population in case of violation in $\bm{\mu}$ distribution 
with different values of $\bm{\epsilon}$ for different finite population size $N$ are tabulated in table \ref{distanceMuHap}.
% figures for mu violation
\input{chapters/vio-mu-hap-table.tex}
From table \ref{distanceMuHap}, average distance calculated for finite population size $4096$ is $0.0158$, 
for size $40960$ is $0.0055$ and for size $81920$ is $0.0041$. These results show average distance 
between finite population and limit $\bm{z^\ast}$ closely follows expected single step distance 
between finite and infinite population given in \ref{tableExpectedDistance}. The distance decreased as $1/\sqrt{N}$.

\input{chapters/violation-mu-dip.tex}
The left column of figures \ref{oscillation_8d_vio_mu_0.01} through \ref{oscillation_14d_vio_mu_0.5} 
shows distance of finite and infinite diploid populations to limit $\bm{z^\ast}$ (limit with violation in $\bm{\mu}$ distribution). The 
right column shows distance of finite and infinite diploid populations to non-violation limits $\bm{p^\ast}$ and $\bm{q^\ast}$. 
Graphs in right column give picture of oscillating behavior of diploid population given violation. 
Graphs in left column in figures \ref{oscillation_8d_vio_mu_0.01} through \ref{oscillation_14d_vio_mu_0.5} show distance 
between finite population and limit $\bm{z}^\ast$ (limit with violation in $\bm{\mu}$ distribution) for diploid case.

Like in haploid case, both finite and infinite populations oscillate given violation. Ripples die out quickly, 
and oscillation ceases for infinite populations, and in the finite population case, although ripple amplitudes decrease, 
oscillation didn't die out completely. 

Change in oscillating behavior of population with change in $\bm{\epsilon}$ values $\{0.01, 0.1, 0.5\}$ were also studied. 
Results show ripples damp out faster with increase $\bm{\epsilon}$.
With smaller values of $\bm{\epsilon}$, oscillations were sharper and as value of $\bm{\epsilon}$ increased, 
rate of damping increased. With $\bm{\epsilon} = 0.01$, oscillation is clearly visible and ripples are sharper; with $\bm{\epsilon} = 0.1$ oscillation was visible 
but ripples were damping out quickly;  with $\bm{\epsilon} = 0.5$, oscillation was very minimal or not visible at all. 

Like just in haploid case, the distance between finite population and limit $\bm{z}^\ast$ (limit with violation in $\bm{\mu}$ distribution) 
decreases as finite population size increases, 
and finite population shows behavior similar to infinite population behavior as finite population reach large number. 
Simulation results show infinite population converges 
to limit $\bm{z^\ast}$ quicker with increase in $\bm{\epsilon}$. 

The distance data for diploid population in case of violation in $\bm{\mu}$ distribution 
with different values of $\bm{\epsilon}$ for different finite population size $N$ are tabulated in table \ref{distanceMuDip}.

% figures for mu violation
\input{chapters/vio-mu-dip-table.tex}

From table \ref{distanceMuDip}, average distance calculated for finite population size $4096$ is $0.0158$, 
for size $40960$ is $0.0055$ and for size $81920$ is $0.0041$. These results show average distance 
between finite population and limit $\bm{z^\ast}$ closely follows expected single step distance 
between finite and infinite population given in \ref{tableExpectedDistance}. The distance decreased as $1/\sqrt{N}$.

Violation introduced to the mutation distribution $\bm{\mu}$ creates new masks (different than in case of without violation) to be used in mutation 
during transmission. With small $\bm{\epsilon}$, the probablility of using the new masks available due to violation is very small and 
those masks might not be used at all during mutation in finite population, but with higher values of $\bm{\epsilon}$, 
those new masks have higher chance of usage during mutation which cause oscillation to damp out quickly or cause no oscillation at all.

From graphs on the right in 
figures \ref{oscillation_8h_vio_mu_0.01} through \ref{oscillation_14h_vio_mu_0.5}, 
and \ref{oscillation_8d_vio_mu_0.01} through \ref{oscillation_14d_vio_mu_0.5}, haploid population shows sharper and 
more distinct oscillations for same size of population size than diploid population; diploid population 
requires larger population size to exhibit sharper oscillations. 
And from graphs on the left in figures \ref{oscillation_8h_vio_mu_0.01} through \ref{oscillation_14h_vio_mu_0.5}, and \ref{oscillation_8d_vio_mu_0.01} through \ref{oscillation_14d_vio_mu_0.5}, diploid population converges to limit $\bm{z}^\ast$ more quickly than haploid population. 

\subsection{Violation in Crossover Distribution}
The crossover distribution $\bm{\chi}$ was modified as
\[
\bm{\chi}_i = (1-\bm{\epsilon}) \bm{\chi} ; \tabspace i = \{1, 2,.., 2^{\ell}-1\} 
\]
So that 
\[
\bm{\chi}_i + \bm{\chi}_{i+g} = 1-\bm{\epsilon} ; \tabspace g \text{ is defined in  section } \ref{Limits}
\]

Then $j$ is chosen where $\bm{\chi}_j = 0$ and set $\bm{\chi}_j = \bm{\epsilon}$. 

Simulations were repeated with the violations in (\ref{OscCond}) described above for crossover distribution.
The distances of both infinite and finite populations to limit $\bm{z}^\ast$ were plotted. 
The distances of both infinite and finite populations to non-violation limits $\bm{p}^\ast$ and $\bm{q}^\ast$ were also plotted.

% figures for chi violation
\input{chapters/violation-chi-hap.tex}
The left column of figures \ref{oscillation_8h_vio_chi_0.01} through \ref{oscillation_14h_vio_chi_0.5} 
shows distance of finite and infinite haploid populations to limit $\bm{z^\ast}$ (limit with violation in crossover distribution $\bm{\chi}$). The 
right column shows distance of finite and infinite haploid populations to non-violation limits $\bm{p^\ast}$ and $\bm{q^\ast}$. 
Graphs in right column give picture of oscillating behavior of haploid population given violation. 
Graphs in left column in figures \ref{oscillation_8h_vio_chi_0.01} through \ref{oscillation_14h_vio_chi_0.5} show distance 
between finite population and limit $\bm{z}^\ast$ (limit with violation in $\bm{\chi}$ distribution) for haploid case.

Both finite and infinite populations oscillate given violation. However, ripples die out quickly, 
and oscillation ceases for infinite populations.
In the finite population case, although ripple amplitudes decrease, oscillation didn't die out completely. 

Change in oscillating behavior of population with change in $\bm{\epsilon}$ values $\{0.01, 0.1, 0.5\}$ were also studied. 
Results show ripples damp out faster with increase $\bm{\epsilon}$.
With smaller values of $\bm{\epsilon}$, oscillations were sharper and as value of $\bm{\epsilon}$ increased, 
rate of damping increased. With $\bm{\epsilon} = 0.01$, oscillation is clearly visible and ripples are sharper; with $\bm{\epsilon} = 0.1$ oscillation was visible 
but ripples were damping out quickly;  with $\bm{\epsilon} = 0.5$, oscillation was very minimal or not visible at all. 

The distance between finite population and limit $\bm{z}^\ast$ (limit with violation in $\bm{\chi}$ distribution) decreases as finite population size increases,
and finite population shows behavior similar to infinite population behavior as finite population reach large number. Simulation results show infinite population converges 
to limit $\bm{z^\ast}$ quicker with increase in $\bm{\epsilon}$. 

The distance data for haploid population in case of violation in $\bm{\chi}$ distribution 
with different values of $\bm{\epsilon}$ for different finite population size $N$ are tabulated in table \ref{distanceChiHap}.

% figures for chi violation
\input{chapters/vio-chi-hap-table.tex}
From table \ref{distanceChiHap}, 
average distance calculated for finite population size $4096$ is $0.0158$, 
for size $40960$ is $0.0055$ and for size $81920$ is $0.0040$.
These results show average distance 
between finite population and limit $\bm{z^\ast}$ closely follows expected single step distance 
between finite and infinite population given in \ref{tableExpectedDistance}. The distance decreased as $1/\sqrt{N}$.

\input{chapters/violation-chi-dip.tex}
The left column of figures \ref{oscillation_8d_vio_chi_0.01} through \ref{oscillation_14d_vio_chi_0.5} 
shows distance of finite and infinite diploid populations to limit $\bm{z^\ast}$ (limit with violation in $\bm{chi}$). The 
right column shows distance of finite and infinite diploid populations to non-violation limits $\bm{p^\ast}$ and $\bm{q^\ast}$. 
Graphs in right column give picture of oscillating behavior of diploid population given violation. 
Graphs in left column in figures \ref{oscillation_8d_vio_chi_0.01} through \ref{oscillation_14d_vio_chi_0.5} show distance 
between finite population and limit $\bm{z}^\ast$ (limit with violation in $\bm{\chi}$ distribution) for diploid case.

Likewise in hapliod population, both finite and infinite diploid populations oscillate given violation. However, ripples die out quickly, 
and oscillation ceases for infinite populations.
In the finite population case, although ripple amplitudes decrease, oscillation didn't die out completely. 

Change in oscillating behavior of population with change in $\bm{\epsilon}$ values $\{0.01, 0.1, 0.5\}$ were also studied. 
Results show ripples damp out faster with increase $\bm{\epsilon}$.
With smaller values of $\bm{\epsilon}$, oscillations were sharper and as value of $\bm{\epsilon}$ increased, 
rate of damping increased. With $\bm{\epsilon} = 0.01$, oscillation is clearly visible and ripples are sharper; with $\bm{\epsilon} = 0.1$ oscillation was visible 
but ripples were damping out quickly;  with $\bm{\epsilon} = 0.5$, oscillation was very minimal or not visible at all. 

The distance between finite population and limit $\bm{z}^\ast$ (limit with violation in $\bm{\chi}$ distribution) decreases as finite population size increases, 
and finite population shows behavior similar to infinite population behavior as finite population reach large number. Simulation results show infinite population converges 
to limit $\bm{z^\ast}$ quicker with increase in $\bm{\epsilon}$. 

The distance data for diploid population in case of violation in $\bm{\chi}$ distribution 
with different values of $\bm{\epsilon}$ for different finite population size $N$ are tabulated in table \ref{distanceChiDip}.

% figures for chi violation
\input{chapters/vio-chi-dip-table.tex}

From table \ref{distanceChiDip}, 
average distance calculated for finite population size $4096$ is $0.0158$, 
for size $40960$ is $0.0055$ and for size $81920$ is $0.0040$.
These results show average distance 
between finite population and limit $\bm{z^\ast}$ closely follows expected single step distance 
between finite and infinite population given in \ref{tableExpectedDistance}. The distance decreased as $1/\sqrt{N}$.

Violation introduced to the crossover distribution $\bm{\chi}$ creates new masks (different than in case of without violation) to be used in crossover 
during transmission. With small $\bm{\epsilon}$, the probablility of using the new masks available due to violation is very small and 
those masks might not be used at all during crossover in finite population, but with higher values of $\bm{\epsilon}$, 
those new masks have higher chance of usage during crossover which cause oscillation to damp out quickly or cause no oscillation at all.

From graphs on the right in 
figures \ref{oscillation_8h_vio_chi_0.01} through \ref{oscillation_14h_vio_chi_0.5}, 
and \ref{oscillation_8d_vio_chi_0.01} through \ref{oscillation_14d_vio_chi_0.5}, haploid population shows sharper and 
more distinct oscillations for same size of population size than diploid population; diploid population 
requires larger population size to exhibit sharper oscillations. 
And from graphs on the left in figures \ref{oscillation_8h_vio_chi_0.01} through \ref{oscillation_14h_vio_chi_0.5}, and \ref{oscillation_8d_vio_chi_0.01} through \ref{oscillation_14d_vio_chi_0.5}, diploid population converges to limit $\bm{z}^\ast$ more quickly than haploid population. 

\section{Summary}
In this chapter, we described limits predicted by Vose for infinite population, and necessary and sufficient condition 
for convergence to periodic orbits. Through experiment, we showed finite population also oscillate, 
and converge to infinite population behavior as population size increases. 
Then we studied through simulations the effect on infinite and finite population behavior of violating the condition 
for convergence to periodic orbits. Infinite population ceases to oscillate when the condition for convergence to 
periodic orbits is violated, but finite population continued to approximately oscillate for small values of $\bm{\epsilon}$. 
For smaller values of $\bm{\epsilon}$, finite population does not get aware of violation because the probability of using 
new masks created in the mutation distribution $\bm{\mu}$ and the crossover distribution $\bm{\mu}$ due to violation is very low, and 
finite population follows behavior of infinite population without violation in the condition for convergence to 
periodic orbits.





 
