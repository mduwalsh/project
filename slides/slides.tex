\documentclass[aspectratio=169]{beamer}
\usepackage{enumitem}
\usepackage{bm}
\usepackage{float}
\usepackage[config, labelfont={bf}]{caption,subfig} % nice sub figures
\setbeamertemplate{footline}[frame number]

\newcommand{\nudge}{\hspace{0.01in}}

\title{Efficient Simulation Of A Simple Evolutionary System}
\author{Mahendra Duwal Shrestha}
\institute{The University Of Tenessee}
\date{\today}


\begin{document}

  \begin{frame}
    \titlepage
  \end{frame}

  \begin{frame}
    \frametitle{Outline}
    \begin{itemize}%[\label{}]
      \item{Background}
      \item{Question 1: Distance between finite and infinite population}
      \item{Question 2: Oscillation in finite population}
      \item{Question 3: Oscillation in finite population under violation in mutation}
      \item{Question 4: Oscillation in finite population under violation in crossover}
      \item{Conclusion}
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Terms}
    \begin{itemize}
      \item{Population $P$: a collection of length $\ell$ binary strings}
      \item{Population vector $\bm{p}$: $\bm{p}_j$ is the proportion of string $j$ in the population}
      \item{If $P \,=\, {00, 01, 01, 10, 11, 11}$, then $\bm{p}_3 \,=\, 2/6 \,=\, 1/3$}
      \item{$\mathcal{R}$ denotes a set binary strings of length $\ell$ }
      \begin{itemize}
	\item{Addition and multiplication of elements in $\mathcal{R}$ are bitwise operations modulo 2}
	\item{$x \,=\, 1101,\, y \,=\, 1010 $}
	\item{$x + y \,=\, 1101 + 1010 \,=\, 0111$}
	\item{$xy \,=\, 1101 \cdot 1010 \,=\, 1000$}
	\item{$\bar{x} \,=\, 0010$}
      \end{itemize}
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Crossover \& Mutation}
    \begin{itemize}
      \item{Crossover : Choose parents $u$ and $v$, exchange bits using crossover mask $m$: }
      \item{$u^\prime \,=\, um + v\bar{m} , v^\prime \,=\, u\bar{m} + vm$}      
      \item{$u = \bm{11001011}, v = 11011111, m = 11110000$}
      \item{$\{\bm{11001011}, 11011111\} \to \{\bm{1100}0000 + 00001111,\; 0000\bm{1011} + 11010000\} \to \{\bm{1100}1111, 1101\bm{1011}\}$}
      \item{Mutation: Flip bits using mutation mask:}
      \item{$x \to x + m$}
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Finite Population GA}
    \begin{columns}
          \column{0.30\linewidth}
             \centering
             \includegraphics[height=6cm, width=7cm]{figures/eps/GA.eps}
           \column{0.66\linewidth}
	    \begin{itemize}
              \item{Randomly select parents $u$ and $v$ }
              \item{Crossover $u$ and $v$ to produce $u^\prime$ and $v^\prime$ }
              \item{Keep one of $u^\prime$, $v^\prime$ , and mutate}
              \item{Repeat above to form next generation}
              \item{Repeat whole process until system stops  to improve or threshold is reached}
	    \end{itemize}
         \end{columns} 
  \end{frame}
  
  \begin{frame}
    \frametitle{Infinite Population Model}
    \begin{itemize}
      \item{Population is modeled as a vector $\bm{p}$}
      \item{$\mathcal{G}$ maps $\bm{p}$ to the next generation}
      \item{$\mathcal{G}(\bm{p})_j$ =  probability that string $j$ occurs in the next generation}
      \item{The infinite population model is the sequence }
      \item{$\bm{p} \to \mathcal{G}(\bm{p}) \to  {\mathcal{G}}(\mathcal{G}(\bm{p})) \to \cdots $}
    \end{itemize}  
  \end{frame}
  
  \begin{frame}
    \frametitle{Random Heuristic Search}
    \begin{itemize}
      \item{$\tau$ is a stochastic transition rule that maps $\bm{p}$ to $\bm{p}$}
      \item{For a finite population, sequence $\bm{p}, \tau(\bm{p}), \tau^2(\bm{p}), \cdots $ forms Markov chain}
      \item{$\tau(\bm{p})$ cannot be predicted with certainty }
      \item{$\mathcal{G}(\bm{p})$ is the expected next generation $\mathcal{E}(\tau(\bm{p}))$}
      \item{The variance in the next generation  is}
      \item{
	\[\mathcal{E}(\| \tau (\bm{p}) - \mathcal{G}(\bm{p}) \|^2) = \frac{1 - \|\mathcal{G}(\bm{p})\|^2}{r}\]
      }
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Question 1: Distance Between Finite and Infinite Population}
    \begin{itemize}
      \item{Chebyshev's inequality $\to$ \[ \| \tau (\bm{p}) - \mathcal{G}(\bm{p}) \| \,\leq\, \frac{k}{\sqrt{r}} \] }
      \item{Jensen's inequality  
      $\to$ \[ \mathcal{E}(\| \tau (\bm{p}) - \mathcal{G}(\bm{p}) \| \,\leq\, \frac{\sqrt{1 - \|\mathcal{G}(\bm{p})\|^2}}{\sqrt{r}}\]}
      \item{Geometric point of view $\to$ \[ \| \tau (\bm{p}) - \mathcal{G}(\bm{p}) \| \,=\, O(r) \] }      
    \end{itemize}
%     \newline
%     \newline
      \mbox{}\\[0.25 in]
    Does the distance decrease in practice like $1/\sqrt{r}$ ?
  \end{frame}
  
  \begin{frame}
    \frametitle{Diploid Population Model}
    \begin{itemize}
      \item{Diploid genome: $\quad \alpha \,= \langle \alpha_0, \alpha_1 \rangle$}
      \item{$\bm{q}^n \, \to \,$ population at generation $n$} 
      \item{$\bm{q}_\alpha^n \, \to \,$ prevalence of diploid $\alpha$}
      \item{$t_\alpha(g) \, \to\,$ probability that gamete $g$ is produced from parent $\alpha$ }
      \item{\[\bm{q}_\gamma^{n+1} \; = \;
      \sum_{\alpha} \, \bm{q}_\alpha^n \, t_\alpha(\gamma_0) 
      \sum_{\beta} \,\bm{q}_\beta^n \, t_\beta(\gamma_1)\]}
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Diploid Model Reduction to Haploid Model}
    \begin{itemize}
      \item{Diploid distribution in terms of haploids
      \[q_{\langle \gamma_0, \gamma_1 \rangle}^{n} \; = \;
      p_{\gamma_0}^{n} \, p_{\gamma_1}^{n}\]}
      \item{Haploid distribution in terms of diploids
      \[ \bm{p}_g^n \, = \, \frac{1}{2} \sum_{\alpha_0, \, \alpha_1} \, \bm{q}_{\langle \alpha_0, \alpha_1 \rangle}^n
	    ([g = \alpha_0] + [g = \alpha_1]) \]}
      \item{Evolution equation in terms of haploid distributions $\bm{p}$,
      \[\bm{p}_{\gamma_0}^{n+1} \,=\, \sum_{\alpha_0, \, \alpha_1} \, \bm{p}_{\alpha_0}^n \, \bm{p}_{\alpha_1}^n \,
	  t_{\langle \alpha_0, \,\alpha_1 \rangle}(\gamma_0) \]}
      \item{Matrix form:
      \[ \bm{p}_g^\prime \; = \; \bm{p}^T M_g \, \bm{p} \] where \[ \Big(M_g \Big)_{u,v} \; = \; t_{\langle u, v \rangle}(g) \]}
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Specialization to Vose's Haploid Model}
    \begin{itemize}
      \item{Mutation: \[\bm{\mu}_i = (\mu)^{{\bf 1}^Ti} (1-\mu)^{\ell- {\bf 1}^Ti} \]}
      \item{Crossover: \[
	\bm{\chi}_i =\begin{cases}
	  \chi c_i & \text{if $i>0$}\\
	  1 - \chi + \chi  c_0 & \text{if $i = 0$}
	\end{cases}
      \]}
      \item{For uniform crossover, $c_i = 2^{-\ell}$}
      \item{\[ t_{\langle u,v \rangle}(g) \; = \;\,
      \sum_{i \nudge \in \nudge \mathcal{R}} \, \sum_{j \nudge \in \nudge \mathcal{R}} \,
      \sum_{k \nudge \in \nudge \mathcal{R}}
      \bm{\mu}_i \nudge \bm{\mu}_j \, \frac{\bm{\chi}_k + \bm{\chi}_{\overline{k}}}{2} \,
      [\nudge k (u + i) + \overline{k}(v + j) \, = \, g\nudge] \] where $u,v \in \mathcal{R}$}
      
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Walsh Basis}
    \begin{itemize}
	\item{$W_{n,t} = N^{-1/2} (-1)^{n^T t}$ where $N = 2^\ell$}
	\item{$\widehat{A} = WAW$}
	\item{$\widehat{w} = Ww$}
	\item{Mixing matrix in Walsh basis 
	\[
	  \widehat{M}_{u,v} \; = \; 2^{\,\ell-1} \,[\nudge u \nudge v = {\bf
	  0}\nudge]\, \widehat{\bm{\mu}}_u \nudge \widehat{\bm{\mu}}_v \!  \sum_{k
	\nudge \in \nudge \overline{u+v} \nudge \mathcal{R}} \bm{\chi}_{k + u} +
	\bm{\chi}_{k + v}
	\]
	}
	\item{Evolution eqn in Walsh basis 
	\[
	  \widehat{\bm{p}}_g^{\,\,\prime} \; = \; 2^{\,\ell/2} \sum_{i \nudge \in \nudge g \mathcal{R}}
	  \widehat{\bm{p}}_i \, \nudge \widehat{\bm{p}}_{i+g} \,\widehat{M}_{i,i+g}
	\]
	 where $g \mathcal{R} = \{g \nudge i \, | \, i \in \mathcal{R} \}$
	}
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Computational Advantages}
    \begin{itemize}
      \item{Specialization simplifies computation, which otherwise for diploid case would have been impractical} 
      \item{Only one mixing matrix as opposed to $2^\ell$ is needed to compute next generation}
      \item{For $\ell = 14$, using $2^14$ mixing matrices with each having $2^14 \cdot 2^14$ 
      entries would require 32 TB of memory, whereas one mixing matrix requires only 2 GB}
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Distance Computation}
    \begin{itemize}      
      \item{Naive computation 
      \[
	\|{\bm f} - {\bm q} \hspace{0.005in} \|^2 \; = \;
	  {\sum_{\alpha}} ({\bm f}_\alpha-{\bm q}_\alpha)^2 
	   \xrightarrow{\hspace*{1cm}} 2^\ell \cdot 2^\ell \, terms 
	\]}
      \item{Our implementation
	\begin{eqnarray*}
	  \|{\bm f} - {\bm q} \hspace{0.005in} \|^2 \; &=& \;
	\sum_{\alpha \notin {S_{\bm f}}} ({\bm f}_\alpha-{\bm q}_\alpha)^2 +
	\sum_{\alpha \in {S_{\bm f}}} ({\bm f}_\alpha-{\bm q}_\alpha)^2 \\	  
	  &=& \; {\sum_{g}}^2 ({\bm p}_{g})^2 \, +
	  \sum_{\alpha \in {S_{\bm f}}} {\bm f}_\alpha ({\bm f}_\alpha- 2 {\bm q}_\alpha) \to 2^\ell + |S_{\bm f}| \, terms 
	\end{eqnarray*}
      }
      \item{\[
	      S_{\bm f} \; = \; \{ \alpha \, | \, {\bm f}_\alpha > 0 \}
	      \]
      }
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Convergence}  
      \[\chi \,=\, 0.1, \; \mu \,=\, 0.001\]
	\begin{figure}[!hb]
	  \begin{center}
	    \subfloat[$\ell = 4$]{
	    \resizebox*{3cm}{!}{\includegraphics{figures/eps/surf/b4.eps}}}\hspace{5pt}
	    \subfloat[$\ell = 6$]{
	    \resizebox*{3cm}{!}{\includegraphics{figures/eps/surf/b6.eps}}}\hspace{5pt}
	    \subfloat[$\ell = 8$]{
	    \resizebox*{3cm}{!}{\includegraphics{figures/eps/surf/b8.eps}}}
	  \end{center}
	  \begin{center}
	  \subfloat[$\ell = 10$]{
	    \resizebox*{3cm}{!}{\includegraphics{figures/eps/surf/b10.eps}}}\hspace{5pt}
	    \subfloat[$\ell = 12$]{
	    \resizebox*{3cm}{!}{\includegraphics{figures/eps/surf/b12.eps}}}\hspace{5pt}
	    \subfloat[$\ell = 14$]{
	    \resizebox*{3cm}{!}{\includegraphics{figures/eps/surf/b14.eps}}}
	    \caption[]{Convergence of finite population behaviour}   
	  \end{center}
	\end{figure}      
    
  \end{frame}
  
  \begin{frame}
    \frametitle{Regression}
    \[\log d = m \log N + b\]
    \begin{figure}[!ht]
      \begin{center}
	\subfloat[Slope $m$]{
	\resizebox*{4cm}{!}{\includegraphics{figures/eps/slope/m.eps}}}\hspace{5pt}
	\subfloat[Intercept $b$]{
	\resizebox*{4cm}{!}{\includegraphics{figures/eps/slope/b.eps}}}
	\caption[]{Regression parameter for generation $n \in \{1, 2, 4, 8, 16, 32, 64, 128\}$ }	
      \end{center}
    \end{figure}
    $d \approx N^m e^b$
    \newline
    From figure (a) above, $m \approx -0.5$ 
    \newline
    $d \approx k / √N$
  \end{frame}  
  
  \begin{frame}
    \frametitle{Conclusion 1}
    \begin{itemize}
      \item{Vose's infinite population model makes computation in diploid case efficient by reducing to the haploid case}  
      \item{Distance between finite diploid population and infinite diploid population can decrease like $1/\sqrt{N}$}
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Question 2}
    \begin{itemize}
      \item{Oscillations in Finite Population Evolution}      
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Limits}
    \begin{itemize}
      \item{The sequence $\bm{p}, \, \mathcal{G}(\bm{p}), \, {\mathcal{G}}^2(\bm{p}), \, \cdots$ may converge to a fixed point }  
      \item{$\mathcal{G}(\omega) = \lim_{n\to\infty} \mathcal{G}^n(\bm{p}) = \omega$}
      \item{But under some circumstances, the sequence converges to a periodic orbit that oscillates between two fixed points, $\bm{p}^\ast$ and $\bm{q}^\ast$}
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Periodic Orbit: Necessary and Sufficient Conditions}
    \begin{itemize}
      \item{For some $g \,\in\, \mathcal{R} , g \,\neq\, 0$}    
      \item{
      \begin{eqnarray*}
      -1 &=& \sum \limits_{j} (-1)^{g^T j} \bm{\mu}_j \\
      1 &=& \sum \limits_{k \in \bar{g}\mathcal{R}} \bm{\chi}_{k+g} + \bm{\chi}_k 
      \end{eqnarray*}
      }
      \item{Infinite populations converge to a periodic orbit }
      \item{Do finite populations also exhibit oscillation from random initial populations?}
    \end{itemize}
  \end{frame}  
  
  \begin{frame}
    \frametitle{Previous Works on Oscillation}
    \begin{itemize}
      \item{Akin (1982) proved existence of cycling for continuous-time 2-bit diploid model}  
      \item{Hasting (1981) studied cycling in populations with infinite 2-bit diploid population model}
      \item{Wright and Bidwell (1997) provided examples of cycling in an infinite haploid model 
      with crossover and mutation for 3 bit and 4 bit populations }
      \item{Wright and Agapie (2001) described cycling in infinite population for up to 4 bits, 
      and also presented data for cycling in finite population}
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{}
    \begin{itemize}
      \item{Akin considered continuous time model and we consider discrete time model}
      \item{Hastings' study was limited to two bits length, and includes only crossover but not mutation}
      \item{Examples provided by Wright and Bidwell were for specific set parameter values for crossover, mutation and fitness }
      \item{Wright and Agapie used dynamic mutation that depends upon where population is in the population space}
      \item{Another difference between Wright and Agapie's work and ours is fitness}
      \item{We study cyclic behavior for:}      
      \begin{itemize}
	\item{fixed fitness function and random: initial population, mutation and crossover distribution}
	\item{higher bit length (up to 14)}
	\item{both haploid and diploid populations, and for both finite and infinite populations}
      \end{itemize}
      \item{We also visualize oscillation}
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Simulation}
    \begin{itemize}
      \item{Simulations were run for both haploid and diploid populations}
      \item{Random initial population}     
      \item{$\ell \;\in\; {8, 10, 12, 14}$}
      \item{$N \;=\; {4096, 40960, 81920}$}
      \item{To visualize oscillation, distance between fixed points and population are plotted}
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{Oscillation}
    \begin{figure}[!h]
      \begin{center}
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b8/n004096_osc_fin_hap.eps}}} \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b8/n040960_osc_fin_hap.eps}}} \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b8/n081920_osc_fin_hap.eps}}} \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b8/osc_inf_hap.eps}}} \vspace{-1em} \hspace{-2.3em}%
	
      \end{center}
      \begin{center}
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b8/n004096_osc_fin_dip.eps}}}  \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b8/n040960_osc_fin_dip.eps}}} \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b8/n081920_osc_fin_dip.eps}}}  \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b8/osc_inf_dip.eps}}} \vspace{-0.5em} \hspace{-2.3em}% 
	
      \caption[]{Infinite and finite population behavior for genome length $\ell = 8$}     
      \end{center}
    \end{figure}
  \end{frame}
  
  \begin{frame}
    \frametitle{Oscillation}
    \begin{figure}[!h]
      \begin{center}
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b12/n004096_osc_fin_hap.eps}}} \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b12/n040960_osc_fin_hap.eps}}} \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b12/n081920_osc_fin_hap.eps}}} \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b12/osc_inf_hap.eps}}} \vspace{-1em} \hspace{-2.3em}%
	
      \end{center}
      \begin{center}
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b12/n004096_osc_fin_dip.eps}}}  \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b12/n040960_osc_fin_dip.eps}}} \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b12/n081920_osc_fin_dip.eps}}}  \hspace{-2.3em}% 
	\subfloat{
	\resizebox{4cm}{2cm}{\includegraphics{figures/eps/osc/b12/osc_inf_dip.eps}}} \vspace{-0.5em} \hspace{-2.3em}% 
	
      \caption[]{Infinite and finite population behavior for genome length $\ell = 12$}     
      \end{center}
    \end{figure}
  \end{frame}
  
  \begin{frame}
    \frametitle{Oscillation: Unusual Behavior}
    \begin{figure}[h]
      \begin{center}
	\subfloat[]{
	\resizebox{7.5cm}{5cm}{\includegraphics{figures/eps/osc/b12/b12_n004096_osc_fin_dip_lvl.eps}}} 
	\caption{Oscillation between different points}	
      \end{center}
    \end{figure}
  \end{frame}
  
  
  \begin{frame}
    \frametitle{Oscillation Amplitude}
    \begin{figure}[h]
      \begin{center}
	\subfloat[]{\label{fig:osc_amp_hap}
	\resizebox{7cm}{5cm}{\includegraphics{figures/eps/osc/osc_amp_hap.eps}}} %
	\subfloat[]{\label{fig:osc_amp_dip}
	\resizebox{7cm}{5cm}{\includegraphics{figures/eps/osc/osc_amp_dip.eps}}} \vspace{-0.5em} %
	\caption[]{Average oscillation amplitude} 
      \end{center}
    \end{figure}
  \end{frame}
  
  
  \begin{frame}
    \frametitle{Conclusion 2}
    \begin{itemize}
      \item{Finite population evolution exhibits approximate oscillations}    
      \item{As $\ell$ increases, oscillation amplitude decreases}
      \item{As population size increases, oscillation amplitude increases and randomness decreases}
      \item{Finite population can also oscillate between different pairs of points for diploid population of smaller size and larger $\ell$ }
    \end{itemize}
  \end{frame}
  
  \begin{frame}
    \frametitle{}
    \begin{itemize}
      \item{}      
    \end{itemize}
  \end{frame}
  
  
  
  
  
  \begin{frame}
    \frametitle{History}
    \begin{itemize}
      \item{Haldane, in 1932, summarized basic population genetics  models : Wright, Fisher and Haldane}
      \item{Several people working with evolution-inspired algorithms in the 1950s and the 1960s –  
      Box (1957), Friedman(1959), Bledsoe (1961), Bremermann (1962), and Reed, Toombs and Baricelli (1967) }
      \item{In 1960s and 1970s, Holland and colleagues formalized  and promoted population based algorithms with crossover and mutation }
      \item{Vose (1999) presented efficient methods for computing with a haploid model using mask-based operators introduced by Geiringer (1944)}
    \end{itemize}
  \end{frame}
  
\end{document}