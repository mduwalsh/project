\chapter{Violation} \label{ch:evolutionary limits}
The results from chapter \ref{ch:oscillation} show that oscillation occurs
when the crossover distribution $\bm{\chi}$, and the mutation distribution $\bm{\mu}$ 
satisfy condition \ref{OscCond}. This chapter explores the robustness of finite population oscillation. 
If the finite population GA is an ergodic Markov chain, then perfect oscillation should not occur. Does approximate oscillation 
in finite populations occur in practice if condition \ref{OscCond} is violated? 
This chapter explores the  
third research question, whether finite populations exhibit approximate oscillation when the Markov chain 
is ergodic.

Error $\bm{\epsilon}$ is introduced to $\bm{\mu}$ and $\bm{\chi}$ distributions so as to 
violate condition \ref{OscCond}. Consequently, $\bm{p}^\ast \;=\; \bm{q}^\ast \;=\; \bm{z}^\ast$. 
Violation of condition \ref{OscCond} in the distributions makes the Markov chain ergodic. The initial population is 
computed using same procedure as described in section \ref{InitPopOsc}. To explore the effects of the degree  
of violation of condition \ref{OscCond} in $\bm{\mu}$ and $\bm{\chi}$, different values of $\bm{\epsilon}$ are used in experiments. 
String length $\ell \;\in\; \{8, 10, 12, 14\}$ are considered for simulation.
Going forward, we use `limit $\bm{z}^\ast$' to denote evolutionary limit when mutation distribution $\bm{\mu}$ or crossover distribution 
$\bm{\chi}$ violates condition \ref{OscCond} violated, and 
`non-violation limits $\bm{p}^\ast$ and $\bm{q}^\ast$' to denote limits without violation.

\section{Violation in Mutation Distribution}
The mutation distribution $\bm{\mu}$ is modified as follows
\[
\bm{\mu}_i = (1-\bm{\epsilon}) \bm{\mu}_i \nudge; \tabspace i = \{0, 1, 2,.., 2^{\ell}-1\}.
\]
Thus the sum of $\bm{\mu}$ distribution becomes, 
\[
1-\bm{\epsilon} = \sum \limits_{i=0}^{2^{\ell}-1} \bm{\mu}_i
\]
Then set
\[
\bm{\mu}_0 = \bm{\epsilon}
\]
% \[
% \bm{\mu}_0 = (1-\bm{\epsilon})\bm{\epsilon}
% \]
% $c$ is total number components in $\bm{\mu}$ satisfying condition $\bm{\mu}_i = 0$ and set those components value as
% \[
% \bm{\mu}_i = \bm{\epsilon}^2/c \; ; \; where \; \bm{\mu}_i = 0
% \]
The mutation distribution $\bm{\mu}$ is normalized such that  $\sum \bm{\mu}_i \;=\; 1$.
This modification makes it possible for any population member to mutate to any other population member via mutation 
provided there is non crossover. From equation \ref{ChiDist}, $k \bar{g} \;=\; k$ is true for any $g$ when $k$ is all $0$s, 
and so we have positive non crossover probability present in all conditions. 

Let us exlore for two cases of $g$ in \ref{OscCond}:

1. When $g$ is all $1$s:\newline
Any mask $j$ with a $1$ at position $k$ ($0 \leq k < \ell$) and $0$ at all other positions can mutate the $k$th bit, and since the 
all $0$s mask has positive probability, strings have an option to not mutate. This makes possibile for any string to mutate to 
any possible string. Let us take an example with $\ell \;=\; 8$. Let $g \;=\; 11111111$. Then, mask 
$i \;=\; 00000100$ will have positive probability according to condition \ref{OscCond}. 
Mask $i$ can be used to mutate the sixthbit of a population member. More generally, 
any bit has the option of mutating or not, so any string can mutate to any other.

2. When $g$ has atleast one $0$:\newline
Any mask with a $1$ at position $k$ and $0$ at all other positions  
will have positive probability if $g$ also is $1$ at position $k$. Thus any bit where $g$ is $1$ has the option of mutating or not.  
Any mask with $1$ in just one of the positions where $g$ has $1$s and also $1$ in just one of the positions where $g$ has $0$s can be used to 
mutate a bit where $g$ is $0$. Let us take an example with $\ell \;=\; 8$. Let $g \;=\; 11001111$. Then, 
mask $i \;=\; 00000100$ will have positive probability according to condition \ref{OscCond}. Also mask 
$j \;=\; 00010100$ will have positive probability. Mask $i$ can be used to mutate the sixth bit, and masks $i$ and $j$ will result in mutating
the fourth bit. More generally, any bit has the option of mutating or not, so any string can mutate to any other. Since any population can therefore 
mutate to any other population (this may involve many generations because there are many population members which may need to be mutated), the Markov 
chain is irreducible.

The Markov chain is also aperiodic. We prove this by simple induction on population $P$. 
Let $S(n)$ be function that $P$ has probability to come back to $P$ in $n$ generation, 
and $S(n) \;=\; 1$ if the probability is positive. 
Our base case is that population $P$ can come back to its state $P$ in one generation. 
Population $P$ can stay in its original state $P$ if no mutation events occur. 
Population $P$ has option not to mutate any other population, since all $0$s mutation mask 
has positive probability. So $S(n) \;=\; 1$ is true when $n \;=\; 1$. Now, let us assume it is true for any $k$ so that $S(k) \;=\; 1$, 
and prove that it is true also for $S(k+1)$. Since $S(k) \;=\; 1$, population $P$ can come back to population $P$ in $n \;= \;k$ generations. 
In $k+1$th generation, population $P$ has option to not to mutate to any other population, and stay in state $P$. So, if $S(n) \;=\; 1$ for 
$n \;=\; k$, then it is also true for $n \;=\; k+1$. And since our base case for $n \;=\; 1$, $S(n) \;=\; 1$ is true, 
$S(n) \;=\; 1$ is true for $n \;=\; 2, 3, $ and so on. 
Since any population state can be returned to in any period of time, the Markov chain is aperiodic. 

Since the Markov chain formed by GA is irreducible and aperiodic, 
the Markov chain is ergodic (see \cite{MarkovChain}). Because of ergodic Markov chain, 
steady state distribution with positive value components exists for the GA.   

Simulations were repeated with the violations in (\ref{OscCond}) described above for mutation distribution.
The distances of both infinite and finite populations to limit $\bm{z}^\ast$ were plotted. 
The distances of both infinite and finite populations to non-violation limits $\bm{p}^\ast$ and $\bm{q}^\ast$ were also plotted.

% figures for mu violation
\subsection{Haploid Population \textasciitilde $\epsilon: 0.01$}
\input{chapters/vio-mu-hap-e0.01.tex}
\subsection{Haploid Population \textasciitilde $\epsilon: 0.1$}
\input{chapters/vio-mu-hap-e0.1.tex}
\subsection{Haploid Population \textasciitilde $\epsilon: 0.5$}
\input{chapters/vio-mu-hap-e0.5.tex}

\subsection{Diploid Population \textasciitilde $\epsilon: 0.01$}
\input{chapters/vio-mu-dip-e0.01.tex}
\subsection{Diploid Population \textasciitilde $\epsilon: 0.1$}
\input{chapters/vio-mu-dip-e0.1.tex}
\subsection{Diploid Population \textasciitilde $\epsilon: 0.5$}
\input{chapters/vio-mu-dip-e0.5.tex}

As value of $\ell$ increases, amplitude of oscillation decreases. 
Populations with larger population size, show better oscillations. 
Diploid populations need larger population size than haploid populations to observe good oscillations.
With increase in value of $\bm{\epsilon}$, 
oscillation in population diminishes, and oscillation completely ceases 
after certain threshold value for $\bm{\epsilon}$. 
Like in oscillations in non-violation case in chapter \ref{ch:oscillation}, diploid populations hopping to other levels 
are observed for string length $\ell$ of values 12 and 14 for population size of 4096 in 
figures \ref{oscillation_12d_vio_mu_0.01}, \ref{oscillation_14d_vio_mu_0.01}, \ref{oscillation_12d_vio_mu_0.1}, 
\ref{oscillation_14d_vio_mu_0.1}, \ref{oscillation_12d_vio_mu_0.5} and \ref{oscillation_14d_vio_mu_0.5}, 
and the behavior is absent when population size is larger.

\section{Violation in Crossover Distribution}
The crossover distribution $\bm{\chi}$ was modified as
\[
\bm{\chi}_i = (1-\bm{\epsilon}) \bm{\chi} ; \tabspace i = \{1, 2,.., 2^{\ell}-1\} 
\]
So that 
\[
\bm{\chi}_i + \bm{\chi}_{i+g} = 1-\bm{\epsilon} ; \tabspace g \text{ is defined in  section } \ref{Limits}
\]

Then $j$ is chosen where $\bm{\chi}_j = 0$ and set $\bm{\chi}_j = \bm{\epsilon}$. 

Simulations were repeated with the violations in (\ref{OscCond}) described above for crossover distribution.
The distances of both infinite and finite populations to limit $\bm{z}^\ast$ were plotted. 
The distances of both infinite and finite populations to non-violation limits $\bm{p}^\ast$ and $\bm{q}^\ast$ were also plotted.

% figures for chi violation
\subsection{Haploid Population \textasciitilde $\epsilon: 0.01$}
\input{chapters/vio-chi-hap-e0.01.tex}
\subsection{Haploid Population \textasciitilde $\epsilon: 0.1$}
\input{chapters/vio-chi-hap-e0.1.tex}
\subsection{Haploid Population \textasciitilde $\epsilon: 0.5$}
\input{chapters/vio-chi-hap-e0.5.tex}

\subsection{Diploid Population \textasciitilde $\epsilon: 0.01$}
\input{chapters/vio-chi-dip-e0.01.tex}
\subsection{Diploid Population \textasciitilde $\epsilon: 0.1$}
\input{chapters/vio-chi-dip-e0.1.tex}
\subsection{Diploid Population \textasciitilde $\epsilon: 0.5$}
\input{chapters/vio-chi-dip-e0.5.tex}

As value of $\ell$ increases, amplitude of oscillation decreases. 
Populations with larger population size, show better oscillations. 
Diploid populations need larger population size than haploid populations to observe good oscillations. 
With increase in value of $\bm{\epsilon}$, 
oscillation in population diminishes, and oscillation completely ceases after certain threshold value for $\bm{\epsilon}$. 
Rate of dampening of oscillation in case of violation in $\bm{\chi}$ is slower than in case of violation in ${\bm{\mu}}$, 
and so we see some oscillation even for $\bm{\epsilon} = 0.5$ for haploid population in this case. 
Diploid populations jumping to other levels 
were observed for string length $\ell$ of values 12 and 14 for population size of 4096 in 
figures \ref{oscillation_12d_vio_chi_0.01}, \ref{oscillation_14d_vio_chi_0.01}, \ref{oscillation_12d_vio_chi_0.1}, 
\ref{oscillation_14d_vio_chi_0.1}, \ref{oscillation_12d_vio_chi_0.5} and \ref{oscillation_14d_vio_chi_0.5}, 
but unlike in case of violation in $\bm{\mu}$, the behavior is not completely absent when population size was larger. 
Random wiggles are seen in populations with larger population size also for $\ell$ = 12 and 14. 
Jumping to other levels are observed for string length $\ell = 10$ when population size is 4096 in figures \ref{oscillation_10d_vio_chi_0.01} 
and \ref{oscillation_10d_vio_chi_0.01}.
For $\ell = 10$, random wiggles are 
noticeable for larger population also when $\bm{\epsilon}$ value is increased to $0.5$ (see figure \ref{oscillation_10d_vio_chi_0.5}).


\section{Summary}
In this chapter, we violated the condition \ref{OscCond} through violation in mutation and crossover distribution, and 
studied infinite and finite populations oscillation behavior with the violation through experiments. 
Infinite population ceases to oscillate when the condition \ref{OscCond} for convergence to 
periodic orbits is violated, but finite population continued to approximately oscillate for small values of $\bm{\epsilon}$. 
For smaller values of $\bm{\epsilon}$, finite population does not get aware of violation because the probability of using 
new masks created in the mutation distribution $\bm{\mu}$ and the crossover distribution $\bm{\mu}$ due to violation is very low, and 
finite population follows behavior of infinite population without violation in the condition for convergence to 
periodic orbits.





 
