\chapter{Violation} \label{ch:evolutionary limits}
The results from chapter \ref{ch:oscillation} show that oscillation occurs
when the crossover distribution $\bm{\chi}$, and the mutation distribution $\bm{\mu}$ 
satisfy condition \ref{OscCond}. This chapter explores the robustness of finite population oscillation. 
If population forms ergodic Markov chain, then oscillation should not occur. Does oscillation 
in finite populations cease in practice if condition \ref{OscCond} is violated? 
This chapter tries to answer this and our  
third research question, whether finite populations exhibit oscillation when the Markov chain 
is ergodic.

Error $\bm{\epsilon}$ is introduced to $\bm{\mu}$ and $\bm{\chi}$ distributions to 
violate condition \ref{OscCond}. Consequently, $\bm{p}^\ast \;=\; \bm{q}^\ast \;=\; \bm{z}^\ast$. 
The violation in the distributions are intended to make Markov chain ergodic. Initial population is 
computed using same procedure as described in section \ref{InitPopOsc}. To understand effects of weight 
of violation in $\bm{\mu}$ and $\bm{\chi}$, different values of $\bm{\epsilon}$ are used in experiments. 
String length $\ell \;\in\; \{8, 10, 12, 14\}$ are considered for simulation.
Going forward, we use `limit $\bm{z}^\ast$' to denote evolutionary limit when crossover distribution 
$\bm{\chi}$ or mutation distribution $\bm{\mu}$ is violated, and 
`non-violation limits $\bm{p}^\ast$ and $\bm{q}^\ast$' to denote limits without violation.

\section{Violation in Mutation Distribution}
The mutation distribution $\bm{\mu}$ is modified as follows
\[
\bm{\mu}_i = (1-\bm{\epsilon}) \bm{\mu}_i \nudge; \tabspace i = \{0, 1, 2,.., 2^{\ell}-1\}.
\]
So that sum of $\bm{\mu}$ distribution becomes, 
\[
1-\bm{\epsilon} = \sum \limits_{i=0}^{2^{\ell}-1} \bm{\mu}_i
\]
Then set
\[
\bm{\mu}_0 = \bm{\epsilon}
\]
% \[
% \bm{\mu}_0 = (1-\bm{\epsilon})\bm{\epsilon}
% \]
% $c$ is total number components in $\bm{\mu}$ satisfying condition $\bm{\mu}_i = 0$ and set those components value as
% \[
% \bm{\mu}_i = \bm{\epsilon}^2/c \; ; \; where \; \bm{\mu}_i = 0
% \]
The mutation distribution $\bm{\mu}$ is normalized such that  $\sum\limits_{i=0}^{2^{\ell}-1}\bm{\mu}_i \;=\; 1$.
This modification makes possible for any population member to mutate to any other possible population member via mutation. 
Let us exlore for two cases of $g$ in \ref{OscCond}:

1. When $g$ is all $1$s:\newline
Any mask $j$ with only one $1$ at any position $k$ ($0 \leq k < \ell$) can mutate $k$th bit in string, and since mask 
all $0$s in has positive probability, strings have option to not mutate. This gives possibility for any string to mutate to 
any possible string in population. Let us take an example with $\ell \;=\; 8$. Let $g \;=\; 11111111$. Then, mask 
$i \;=\; 00000100$ will have positive probability according to condition \ref{OscCond} implementation. 
Mask $i$ can be used to mutate bit of a population string at position $k \;=\; 5$ from left.

2. When $g$ has atleast one $0$:\newline
Any mask $j$ with only one $1$ at any position $k$ ($0 \leq k < \ell$) where $k$th position in $g$ also has $1$ in it 
will have positive probability. So any string can mutate that particular $k$th bit using those masks. And any mask 
with $1$ in any one of the position where $g$ has one in it and $1$ in any position where $g$ has $0$s in it can be used to 
mutate bits in string where $g$ has $0$s in it. Let us take an example with $\ell \;=\; 8$. Let $g \;=\; 11001111$. Then, 
mask $i \;=\; 00000100$ will have positive probability according to condition \ref{OscCond} implementation. Then, also mask 
$j \;=\; 00010100$ will have positive probability. Mask $i$ can be used to mutate string at position $k \;=\; 5$. 
To mutate bit of any string at position $k \;=\; 3$, string can be mutated using mask $i$ and mask $j$ in sequence.

Population in state $P$ can mutate to another state $P^\prime$ in next generation. Then it can mutate back to original state $P$ or 
stay in its state $P^\prime$ or move to another state $P^{\prime\prime}$ in next generation. Since population state can mutate to 
any state, and any state can be returned to in any period of time, the Markov chain formed by GA is irreducible and aperiodic and hence, 
ergodic (see \cite{MarkovChain}). Because of ergodic Markov chain, steady state distribution with positive value components exists for the GA.   

Simulations were repeated with the violations in (\ref{OscCond}) described above for mutation distribution.
The distances of both infinite and finite populations to limit $\bm{z}^\ast$ were plotted. 
The distances of both infinite and finite populations to non-violation limits $\bm{p}^\ast$ and $\bm{q}^\ast$ were also plotted.

% figures for mu violation
\subsection{Haploid Population}
% \subsubsection{$\bm{\epsilon: 0.01}$}
\input{chapters/vio-mu-hap-e0.01.tex}
% \subsubsection{$\bm{\epsilon: 0.1}$}
\input{chapters/vio-mu-hap-e0.1.tex}
% \subsubsection{$\bm{\epsilon: 0.5}$}
\input{chapters/vio-mu-hap-e0.5.tex}

\subsection{Diploid Population}
% \subsubsection{$\bm{\epsilon: 0.01}$}
\input{chapters/vio-mu-dip-e0.01.tex}
% \subsubsection{$\bm{\epsilon: 0.1}$}
\input{chapters/vio-mu-dip-e0.1.tex}
% \subsubsection{$\bm{\epsilon: 0.5}$}
\input{chapters/vio-mu-dip-e0.5.tex}

As value of $\ell$ increases, amplitude of oscillation decreases. 
Also as value of $\ell$ increases, random wiggling occurs for smaller population size, 
and larger population size is needed to observe good oscillations. Random wiggling of 
population is more evident in diploid case than in haploid case because length of 
population member string in diploid is $2\ell$. With increase in value of $\bm{\epsilon}$, 
oscillation in population diminishes, and oscillation completely ceases after certain threshold value for $\bm{\epsilon}$. 

\section{Violation in Crossover Distribution}
The crossover distribution $\bm{\chi}$ was modified as
\[
\bm{\chi}_i = (1-\bm{\epsilon}) \bm{\chi} ; \tabspace i = \{1, 2,.., 2^{\ell}-1\} 
\]
So that 
\[
\bm{\chi}_i + \bm{\chi}_{i+g} = 1-\bm{\epsilon} ; \tabspace g \text{ is defined in  section } \ref{Limits}
\]

Then $j$ is chosen where $\bm{\chi}_j = 0$ and set $\bm{\chi}_j = \bm{\epsilon}$. 

Simulations were repeated with the violations in (\ref{OscCond}) described above for crossover distribution.
The distances of both infinite and finite populations to limit $\bm{z}^\ast$ were plotted. 
The distances of both infinite and finite populations to non-violation limits $\bm{p}^\ast$ and $\bm{q}^\ast$ were also plotted.

% figures for chi violation
\subsection{Haploid Population}
% \subsubsection{$\bm{\epsilon}: 0.01$}
\input{chapters/vio-chi-hap-e0.01.tex}
% \subsubsection{$\bm{\epsilon}: 0.1$}
\input{chapters/vio-chi-hap-e0.1.tex}
% \subsubsection{$\bm{\epsilon}: 0.5$}
\input{chapters/vio-chi-hap-e0.5.tex}
 
\subsection{Diploid Population}
% \subsubsection{$\bm{\epsilon}: 0.01$}
\input{chapters/vio-chi-dip-e0.01.tex}
% \subsubsection{$\bm{\epsilon}: 0.1$}
\input{chapters/vio-chi-dip-e0.1.tex}
% \subsubsection{$\bm{\epsilon}: 0.5$}
\input{chapters/vio-chi-dip-e0.5.tex}

As value of $\ell$ increases, amplitude of oscillation decreases. 
Like in case of $\bm{\mu}$ violation, also as value of $\ell$ increases, random wiggling occurs for smaller population size, 
and larger population size is needed to observe good oscillations. Random wiggling of 
population is more evident in diploid case than in haploid case because length of 
population member string in diploid is $2\ell$. With increase in value of $\bm{\epsilon}$, 
oscillation in population diminishes, and oscillation completely ceases after certain threshold value for $\bm{\epsilon}$. 
Rate of dampening of oscillation in case of violation in $\bm{\chi}$ is slower than in case of violation in ${\bm{\mu}}$, 
and so we see some oscillation even for $\bm{\epsilon} = 0.5$ for haploid population in this case. 


\section{Summary}
In this chapter, we violated the condition \ref{OscCond} through violation in mutation and crossover distribution, and 
studied infinite and finite populations oscillation behavior with the violation through experiments. 
Infinite population ceases to oscillate when the condition \ref{OscCond} for convergence to 
periodic orbits is violated, but finite population continued to approximately oscillate for small values of $\bm{\epsilon}$. 
For smaller values of $\bm{\epsilon}$, finite population does not get aware of violation because the probability of using 
new masks created in the mutation distribution $\bm{\mu}$ and the crossover distribution $\bm{\mu}$ due to violation is very low, and 
finite population follows behavior of infinite population without violation in the condition for convergence to 
periodic orbits.





 
